<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Kavi on Pairing Duty | False Productivity</title>
<meta name="keywords" content="dynamic programming, combinatorics, math, number theory" />
<meta name="description" content="Codeforces - Kavi on Pairing Duty (1528B) solution">
<meta name="author" content="colossal_pepe">
<link rel="canonical" href="https://colossal-pepe.github.io/false-productivity/posts/2021-6/kavi-on-pairing-duty/" />
<link crossorigin="anonymous" href="/false-productivity/assets/css/stylesheet.min.b50dea21cb69b925c783abc4870e38fef3e55317f404eef2740034ed7a1c0ac5.css" integrity="sha256-tQ3qIctpuSXHg6vEhw44/vPlUxf0BO7ydAA07XocCsU=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://colossal-pepe.github.io/false-productivity/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://colossal-pepe.github.io/false-productivity/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://colossal-pepe.github.io/false-productivity/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://colossal-pepe.github.io/false-productivity/apple-touch-icon.png">
<link rel="mask-icon" href="https://colossal-pepe.github.io/false-productivity/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.83.1" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js" integrity="sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>
<meta property="og:title" content="Kavi on Pairing Duty" />
<meta property="og:description" content="Codeforces - Kavi on Pairing Duty (1528B) solution" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://colossal-pepe.github.io/false-productivity/posts/2021-6/kavi-on-pairing-duty/" /><meta property="og:image" content="https://colossal-pepe.github.io/false-productivity/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-04T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-06-04T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://colossal-pepe.github.io/false-productivity/papermod-cover.png"/>

<meta name="twitter:title" content="Kavi on Pairing Duty"/>
<meta name="twitter:description" content="Codeforces - Kavi on Pairing Duty (1528B) solution"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://colossal-pepe.github.io/false-productivity/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Kavi on Pairing Duty",
      "item": "https://colossal-pepe.github.io/false-productivity/posts/2021-6/kavi-on-pairing-duty/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Kavi on Pairing Duty",
  "name": "Kavi on Pairing Duty",
  "description": "Codeforces - Kavi on Pairing Duty (1528B) solution",
  "keywords": [
    "dynamic programming", "combinatorics", "math", "number theory"
  ],
  "articleBody": "Abridged Problem Statement There is no abridged problem statement. Go here for full statement.\nSolution Note: Points on the OX line will be 1-indexed, meaning 1st point from left will be at (1, 0). For the rest of this, the y-coordinate will be ignored.\nFirst, we will make a few observations. For that, we will very much require a picture.\nThis is the solution of the 3rd sample input, with $n=3$. Let’s label each of the arcs, or segments $R,G,B$ just because they’re like that in the picture as well. For any segment $S$, the starting point and ending point of that segment is denoted by $S_l$ and $S_r$ respectively.\nNow that terminologies are out of the way, let’s make a few observations.\n  First, notice the following: in solution 2, 3 and 4 of the above image, $R$ contains all the other segments. The effective range went from $[1,6]$ to $[2,4]$. Range $[2,4]$ has length 2, and from the sample output we know that the length 2 has 3 solutions. This means that we can solve for any range independently (these are the subproblems) and combine them efficiently with the bigger range (the larger problem that we are trying to solve). Hence we can use dynamic programming.\n  Now, we consider the rules that we need to follow. Let’s do it case by case. Suppose we have an effective range $[l,r]$.\n  Case 1: All segments in range are equal.\nLet’s place $A$ and $A_l = l$. Now, of course we need place same length segments starting at all points $i$ such that $A_l So this means we are looking for all $A_r - A_l$ which are factors of $\\frac{r-l+1}{2}$.Hence, for case 1, our number of ways is $D\\left(\\frac{r - l + 1}{2}\\right)$ where $D(x)$ is a function which gives the number of factors $x$ has.\n  Case 2: All segments in range are not equal.\nAgain, let’s place $A$ and $A_l = l$. With a little bit of scribbling examples, its easy to see that we can leave $2, 4, \\ldots , A_r - A_l + 1 - 2$ points in the middle unused. Meaning, except for the middle points, all the other points at the sides will be occupied by segments which have the same length as $A$. As we saw from (1), we can solve for these ranges independently and store their results in a $dp$ array.\n    The only thing remaining is convincing ourselves that we have all cases covered. You can read this post over and over again to convince yourself of this, since proving this is quite wordy.\n  So our algorithm is the following, let $dp[i]$ be our memoization array which will store the result, or solution for number of points equal to $i$. Therefore, $$ dp[i] = \\begin{cases} 0 \u0026 \\text{if $i = 2m+1$} \\\\[0.8em] D(i)+\\sum_{j=1}^{2i-2} \u0026 \\text{otherwise} \\end{cases} $$ This still has $\\mathcal{O}(n^2)$ running time if we compute the $2, \\ldots, d[i-2]$ sum every time. I was getting TLE because I wasn’t noticing this. So I made the $dp$ array a prefix-summed array so I just do $dp[2i] = D(i) + dp[2i-2]$. Of course the answer is simply $dp[2n]$.\nCode Time complexity: $\\mathcal{O}(n)$\n#include #include using namespace std; typedef long long ll; ll MOD = 998244353; ll n, factors[2000005], memo[2000005]; void setup() { for (ll i = 1; i  2000005; i++) { for (ll j = i; j  2000005; j += i) { factors[j] += 1; } } } ll solve(ll l) { if (l == 0) return 0; if (memo[l] != 0) return memo[l]; memo[l] += factors[l/2]; memo[l] %= MOD; memo[l] += solve(l-2); memo[l] %= MOD; if (l  2*n) { memo[l] += solve(l-2); memo[l] %= MOD; } return memo[l]; } int main() { setup(); cin  n; cout  solve(2*n)  endl; return 0; } ",
  "wordCount" : "794",
  "inLanguage": "en",
  "datePublished": "2021-06-04T00:00:00Z",
  "dateModified": "2021-06-04T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "colossal_pepe"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://colossal-pepe.github.io/false-productivity/posts/2021-6/kavi-on-pairing-duty/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "False Productivity",
    "logo": {
      "@type": "ImageObject",
      "url": "https://colossal-pepe.github.io/false-productivity/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://colossal-pepe.github.io/false-productivity/" accesskey="h" title="False Productivity (Alt + H)">False Productivity</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://colossal-pepe.github.io/false-productivity/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://colossal-pepe.github.io/false-productivity/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://colossal-pepe.github.io/false-productivity/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://colossal-pepe.github.io/false-productivity/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Kavi on Pairing Duty
    </h1>
    <div class="post-description">
      Codeforces - Kavi on Pairing Duty (1528B) solution
    </div>
    <div class="post-meta">June 4, 2021&nbsp;·&nbsp;colossal_pepe
</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">Table of Contents</div>
        </summary>
        <div class="inner"><ul>
                <li>
                    <a href="#abridged-problem-statement" aria-label="Abridged Problem Statement">Abridged Problem Statement</a></li>
                <li>
                    <a href="#solution" aria-label="Solution">Solution</a></li>
                <li>
                    <a href="#code" aria-label="Code">Code</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="abridged-problem-statement">Abridged Problem Statement<a hidden class="anchor" aria-hidden="true" href="#abridged-problem-statement">#</a></h2>
<p>There is no abridged problem statement. Go <a href="https://codeforces.com/problemset/problem/1528/B">here</a> for full statement.</p>
<h2 id="solution">Solution<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h2>
<p>Note: Points on the OX line will be 1-indexed, meaning 1st point from left will be at (1, 0). For the rest of this, the y-coordinate will be ignored.</p>
<p>First, we will make a few observations. For that, we will very much require a picture.</p>
<p><img loading="lazy" src="https://espresso.codeforces.com/e76da31b813159fceda7384171f18a815ea7fa3d.png" alt="Solution example"  />
</p>
<p>This is the solution of the 3rd sample input, with $n=3$. Let&rsquo;s label each of the arcs, or segments $R,G,B$ just because they&rsquo;re like that in the picture as well. For any segment $S$, the starting point and ending point of that segment is denoted by $S_l$ and $S_r$ respectively.</p>
<p>Now that terminologies are out of the way, let&rsquo;s make a few observations.</p>
<ol>
<li>
<p>First, notice the following: in solution 2, 3 and 4 of the above image, $R$ contains all the other segments. The <em>effective range</em> went from $[1,6]$ to $[2,4]$. Range $[2,4]$ has length 2, and from the sample output we know that the length 2 has 3 solutions. This means that we can solve for any range independently (these are the subproblems) and combine them efficiently with the bigger range (the larger problem that we are trying to solve). Hence we can use dynamic programming.</p>
</li>
<li>
<p>Now, we consider the rules that we need to follow. Let&rsquo;s do it case by case. Suppose we have an effective range $[l,r]$.</p>
<ul>
<li>
<p>Case 1: All segments in range are equal.</p>
<p>Let&rsquo;s place $A$ and $A_l = l$. Now, of course we need place same length segments starting at all points $i$ such that $A_l &lt; i &lt; A_r$. Let the rightest segment starting on one of these points be $B$, so we have $B_l = A_r - 1$. Hence the length of the whole thing (length of range $[A_l, B_r]$) is $A_r - 1 + \text{len($B$)} - A_l$ which is equal to $2(A_r - A_l) - 1$. But instead we will use the number of points (which is $2(A_r - A_l)$) taken up by this placement instead of the length. To explain why we do this, look at the 1st solution, notice that there are 2 unit lengths which none of the segments occupy. There are ways to account for this, but instead we will just use the number of points. Hence, we have:
$$
q \cdot (\text{number of points in range $[A_l, B_r]$}) = \text{number of points in range $[l, r]$} \\[0.7em]
\implies 2q(A_r - A_l) = r - l + 1 \\[0.7em]
\implies A_r - A_l = \frac{r - l + 1}{2q}
$$</p>
<p>So this means we are looking for all $A_r - A_l$ which are factors of $\frac{r-l+1}{2}$.Hence, for case 1, our number of ways is $D\left(\frac{r - l + 1}{2}\right)$ where $D(x)$ is a function which gives the number of factors $x$ has.</p>
</li>
<li>
<p>Case 2: All segments in range are not equal.</p>
<p>Again, let&rsquo;s place $A$ and $A_l = l$. With a little bit of scribbling examples, its easy to see that we can leave $2, 4, \ldots , A_r - A_l + 1 - 2$ points in the middle unused. Meaning, except for the middle points, all the other points at the sides will be occupied by segments which have the same length as $A$. As we saw from (1), we can solve for these ranges independently and store their results in a $dp$ array.</p>
</li>
</ul>
</li>
<li>
<p>The only thing remaining is convincing ourselves that we have all cases covered. You can read this post over and over again to convince yourself of this, since proving this is quite wordy.</p>
</li>
</ol>
<p>So our algorithm is the following, let $dp[i]$ be our memoization array which will store the result, or solution for number of points equal to $i$. Therefore,
$$
dp[i] =
\begin{cases}
0 &amp; \text{if $i = 2m+1$} \\[0.8em]
D(i)+\sum_{j=1}^{2i-2} &amp; \text{otherwise}
\end{cases}
$$
This still has $\mathcal{O}(n^2)$ running time if we compute the $2, \ldots, d[i-2]$ sum every time. I was getting TLE because I wasn&rsquo;t noticing this. So I made the $dp$ array a prefix-summed array so I just do $dp[2i] = D(i) + dp[2i-2]$. Of course the answer is simply $dp[2n]$.</p>
<h2 id="code">Code<a hidden class="anchor" aria-hidden="true" href="#code">#</a></h2>
<p>Time complexity: $\mathcal{O}(n)$</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;cmath&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;

<span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">long</span> <span style="color:#66d9ef">long</span> ll;

ll MOD <span style="color:#f92672">=</span> <span style="color:#ae81ff">998244353</span>;

ll n, factors[<span style="color:#ae81ff">2000005</span>], memo[<span style="color:#ae81ff">2000005</span>];

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setup</span>() {
    <span style="color:#66d9ef">for</span> (ll i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2000005</span>; i<span style="color:#f92672">++</span>) {
        <span style="color:#66d9ef">for</span> (ll j <span style="color:#f92672">=</span> i; j <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2000005</span>; j <span style="color:#f92672">+=</span> i) {
            factors[j] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>;
        }
    }
}

ll <span style="color:#a6e22e">solve</span>(ll l) {
    <span style="color:#66d9ef">if</span> (l <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> (memo[l] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> memo[l];
    memo[l] <span style="color:#f92672">+=</span> factors[l<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>];
    memo[l] <span style="color:#f92672">%=</span> MOD;
    memo[l] <span style="color:#f92672">+=</span> solve(l<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>);
    memo[l] <span style="color:#f92672">%=</span> MOD;
    <span style="color:#66d9ef">if</span> (l <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n) {
        memo[l] <span style="color:#f92672">+=</span> solve(l<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>);
        memo[l] <span style="color:#f92672">%=</span> MOD;
    }
    <span style="color:#66d9ef">return</span> memo[l];
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
    setup();
    cin <span style="color:#f92672">&gt;&gt;</span> n;
    cout <span style="color:#f92672">&lt;&lt;</span> solve(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n) <span style="color:#f92672">&lt;&lt;</span> endl;
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div>
</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://colossal-pepe.github.io/false-productivity/tags/dynamic-programming/">dynamic programming</a></li>
      <li><a href="https://colossal-pepe.github.io/false-productivity/tags/combinatorics/">combinatorics</a></li>
      <li><a href="https://colossal-pepe.github.io/false-productivity/tags/math/">math</a></li>
      <li><a href="https://colossal-pepe.github.io/false-productivity/tags/number-theory/">number theory</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="https://colossal-pepe.github.io/false-productivity/posts/2021-5/combinatorial-intuition-for-binomial-theorem/">
    <span class="title">Next Page »</span>
    <br>
    <span>Combinatorial Intuition for the Binomial Theorem</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://colossal-pepe.github.io/false-productivity/">False Productivity</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
